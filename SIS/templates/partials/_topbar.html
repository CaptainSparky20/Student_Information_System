{% load static %}
{% block content %}
<!-- Admin Top Navigation Header -->
<div class="relative z-[9999] bg-white/10 dark:bg-white/5 backdrop-blur-md rounded-2xl p-4 border border-white/20 dark:border-white/10 shadow-xl mb-8">
  <div class="flex justify-between items-center">
    <!-- Logo and Clickable Dashboard Title -->
    <div class="flex items-center space-x-4">
      <img src="{% static 'images/breyer.jpg' %}" alt="Breyer Logo" class="h-12 w-auto">
      <div>
        <a href="{% url 'dashboard:main_dashboard' %}" class="text-2xl font-bold text-white hover:text-blue-400 transition">
          {% if request.user.role == 'ADMIN' %}
            Admin Dashboard
          {% elif request.user.role == 'LECTURER' %}
            Lecturer Dashboard
          {% elif request.user.role == 'STUDENT' %}
            Student Dashboard
          {% else %}
            Dashboard
          {% endif %}
        </a>
        <p class="text-gray-300 text-sm">{{ request.user.get_full_name|default:request.user.email }}</p>
      </div>
    </div>

    <!-- Live Date/Time and Profile -->
    <div class="flex items-center space-x-6">
      <div class="text-right">
        <p class="text-white font-medium" id="current-date"></p>
        <p class="text-gray-300 text-sm" id="current-time"></p>
      </div>

      <!-- Profile Menu Wrapper -->
      <div class="relative z-[99999]">
        <button id="profile-btn" onclick="toggleProfileMenu(event)" class="relative group focus:outline-none">
          {% if request.user.profile_picture %}
            <img src="{{ request.user.profile_picture.url }}" alt="Profile Picture"
                 class="w-12 h-12 rounded-full object-cover border-2 border-white/20 group-hover:border-blue-400 transition-colors">
          {% else %}
            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center border-2 border-white/20 group-hover:border-blue-400 transition-colors">
              <span class="text-white font-semibold text-lg">
                {{ request.user.get_full_name|first|upper|default:request.user.email|first|upper }}
              </span>
            </div>
          {% endif %}
          <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>
        </button>

        <!-- Profile Dropdown -->
        <div id="profile-menu" class="hidden absolute right-0 top-14 w-56 rounded-2xl
          bg-white/15 dark:bg-white/10
          border border-white/20 dark:border-white/10
          shadow-2xl ring-1 ring-black/10
          backdrop-blur-xl overflow-hidden z-[999999] transition-all">
          <a href="{% url 'dashboard:profile' %}" class="flex items-center px-4 py-3 hover:bg-white/20 dark:hover:bg-white/10 text-gray-900 dark:text-white transition">
            {% include "lucide/user.svg" %}<span class="ml-2">My Profile</span>
          </a>
          <a href="{% url 'dashboard:profile_update' %}" class="flex items-center px-4 py-3 hover:bg-white/20 dark:hover:bg-white/10 text-gray-900 dark:text-white transition">
            {% include "lucide/edit-3.svg" %}<span class="ml-2">Update Profile</span>
          </a>
          <a href="{% url 'password_change' %}" class="flex items-center px-4 py-3 hover:bg-white/20 dark:hover:bg-white/10 text-gray-900 dark:text-white transition">
            {% include "lucide/key.svg" %}<span class="ml-2">Change Password</span>
          </a>
          <form action="{% url 'logout' %}" method="post">
            {% csrf_token %}
            <button type="submit" class="flex items-center w-full px-4 py-3 text-red-600 hover:bg-white/20 dark:hover:bg-white/10 transition">
              {% include "lucide/log-out.svg" %}<span class="ml-2">Logout</span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function updateDateTime() {
    const now = new Date();
    const date = now.toLocaleDateString(undefined, { year:'numeric', month:'long', day:'numeric' });
    const time = now.toLocaleTimeString(undefined, { hour: '2-digit', minute: '2-digit', hour12: true });
    document.getElementById('current-date').textContent = date;
    document.getElementById('current-time').textContent = time;
  }
  updateDateTime();
  setInterval(updateDateTime, 1000);

  function toggleProfileMenu(e) {
    e.stopPropagation();
    document.getElementById('profile-menu').classList.toggle('hidden');
  }

  document.addEventListener('click', (e) => {
    const menu = document.getElementById('profile-menu');
    if (!menu.contains(e.target) && !document.getElementById('profile-btn').contains(e.target)) {
      menu.classList.add('hidden');
    }
  });
</script>
{% block adminportal_content %}{% endblock %}
{% endblock %}
