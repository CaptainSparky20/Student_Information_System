{% extends 'lecturer/base_lecturer.html' %}
{% load static %}

{% block title %}Parents / Guardians{% endblock %}

{% block content_inner %}
<div class="max-w-4xl mx-auto bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20 shadow-xl mt-10 text-white">

  <div class="flex items-start justify-between mb-6">
    <div>
      <h1 class="text-2xl font-bold">Parents / Guardians</h1>
      <p class="text-gray-300 mt-1">Student: <span class="font-semibold">{{ student.user.full_name }}</span></p>
    </div>
    <a href="{% url 'lecturer:add_parent_details' student.id %}"
       class="px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white">
      + Add Parent / Guardian
    </a>
  </div>

  {% if parents %}
    <div class="space-y-4">
      {% for p in parents %}
        <div class="flex items-center justify-between bg-white/5 border border-white/20 rounded-xl p-4">
          <div class="flex items-center gap-4">
            {% if p.profile_picture %}
              <img src="{{ p.profile_picture.url }}" class="w-12 h-12 rounded-full object-cover border border-white/20" alt="">
            {% else %}
              <div class="w-12 h-12 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center font-bold">
                {{ p.user.get_short_name|first|default:"P" }}
              </div>
            {% endif %}
            <div>
              <div class="font-semibold">{{ p.user.full_name }}</div>
              <div class="text-sm text-gray-300">{{ p.user.email }}</div>
              {% if p.roles %}
                <div class="mt-1 text-xs">
                  {% for r in p.get_roles_list %}
                    <span class="inline-block px-2 py-0.5 rounded bg-blue-900/40 text-blue-100 mr-1">{{ r }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            </div>
          </div>
          <form method="post" action="{% url 'lecturer:remove_parent' student.id p.id %}">
            {% csrf_token %}
            <button type="submit"
                    class="px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white text-sm">
              Remove
            </button>
          </form>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="text-gray-300">
      No parents/guardians linked yet.
    </div>
  {% endif %}

  <div class="mt-8">
    <a href="{% url 'lecturer:classgroup_student_list' student.class_group.id %}"
       class="px-4 py-2 rounded-lg bg-gray-600 hover:bg-gray-700 text-white">
      Back to Students
    </a>
  </div>
</div>
{% endblock %}
