{% extends 'adminportal/base_adminportal.html' %}
{% load static %}
{% load widget_tweaks %}

{% block title %}Add Staff{% endblock %}

{% block content_inner %}
<div class="max-w-2xl mx-auto bg-white/10 rounded-2xl p-8 border border-white/20 shadow-xl mt-10">
  <h1 class="text-3xl font-bold text-white mb-6 text-center">Add New Staff</h1>

  {% if not_permitted %}
    <div class="bg-red-700 text-white p-6 rounded mb-4 text-xl text-center font-bold">
      You are not permitted to add staff.<br>
      Only superusers can perform this action.
    </div>
  {% else %}
    <form method="post" enctype="multipart/form-data" class="space-y-6">
      {% csrf_token %}

      {% if messages %}
        {% for message in messages %}
          <div class="p-4 mb-3 rounded 
              {% if 'error' in message.tags %}bg-red-100 text-red-700
              {% elif 'success' in message.tags %}bg-green-100 text-green-700
              {% else %}bg-gray-100 text-gray-700{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}

      {% if form.non_field_errors %}
        <div class="bg-red-700 text-white p-3 rounded mb-4">
          {% for error in form.non_field_errors %}
            <div>{{ error }}</div>
          {% endfor %}
        </div>
      {% endif %}

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {% for field in form.visible_fields %}
          <div class="{% if field|field_type == 'TextareaField' or field.name == 'department' %}md:col-span-2{% endif %}">
            <label for="{{ field.id_for_label }}" class="block text-gray-300 mb-2 font-semibold">
              {{ field.label }}{% if field.field.required %}<span class="text-red-400">*</span>{% endif %}
            </label>
            {% if field.errors %}
              {{ field|add_class:"w-full px-4 py-3 rounded-lg bg-white/10 border-2 border-red-400 text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500" }}
            {% else %}
              {{ field|add_class:"w-full px-4 py-3 rounded-lg bg-white/5 border border-white/20 text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500" }}
            {% endif %}
            {% if field.help_text %}
              <p class="text-xs text-gray-400">{{ field.help_text }}</p>
            {% endif %}
            {% for error in field.errors %}
              <p class="text-xs text-red-400 mt-1">{{ error }}</p>
            {% endfor %}
          </div>
        {% endfor %}
      </div>

      <button type="submit" class="w-full py-3 mt-8 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-bold shadow-lg transition-all text-lg">
        Add Staff
      </button>
    </form>
  {% endif %}
</div>
{% endblock %}
